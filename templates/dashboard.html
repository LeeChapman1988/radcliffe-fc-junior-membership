{% extends "base.html" %}

{% block content %}
<h2>My Children</h2>

{% if children %}
    {% for child in children %}
        <div class="card mb-3">
            <div class="card-body">
                <h3>{{ child.full_name }}</h3>

                <p><strong>Date of Birth:</strong> {{ child.date_of_birth.strftime("%d/%m/%Y") }}</p>
                <p><strong>Team / Group:</strong> {{ child.team_name }}</p>

                {% if child.applications %}
                    <h4>Membership Application</h4>
                    {% for application in child.applications %}
                        <p><strong>Status:</strong> {{ application.status }}</p>

                        {% if application.status == 'approved' and child.card %}
                            <p><strong>Card number:</strong> {{ child.card.card_number }}</p>
                            <p>
                                <strong>Download card:</strong>
                                <a href="{{ url_for('download_card', card_filename=child.card.card_image_filename) }}" target="_blank">
                                    Download membership card
                                </a>
                            </p>
                        {% elif application.status == 'pending' %}
                            <p>Your application is currently being reviewed.</p>
                        {% elif application.status == 'rejected' %}
                            <p>Your application has been rejected. Please contact the club for more information.</p>
                        {% endif %}
                    {% endfor %}
                {% else %}
                    <p>No membership applications found for this child.</p>
                    <a class="btn btn-primary" href="{{ url_for('apply') }}">Apply for membership</a>
                {% endif %}
            </div>
        </div>
    {% endfor %}
{% else %}
    <p>You have not added any children yet.</p>
{% endif %}

{% endblock %}
